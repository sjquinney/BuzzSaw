<html>
<head>
<title>BuzzSaw Filters</title>
</head>
<body>
<h1>BuzzSaw Filters</h1>

<h2>Introduction</h2>

<p>
After each log entry has been parsed into its constituent parts it is
next passed on to the data filtering stage of the pipeline. This is
the stage at which decisions are made as to whether a log entry should
be accepted into the database. If no filters have been specified then
the importer process will import all entries into the
database. Otherwise, if there are 1 or more filters, then no entries
are accepted by default, at least one filter must declare an interest
in a log entry for it to be stored. Each log entry is passed through
the entire stack of filters in the order in which they were
specified. As well as declaring an interest in a log entry filters are
permitted to attach tags and associate other information with an
entry, which will be stored in the database for later retrieval
(e.g. when generating reports). The result of this is that subsequent
filters can make decisions and do further processing based on the
results of filters earlier in the pipeline. It is worth noting however
that an entry will be accepted if ANY filter declares an interest, it
is not possible for filters later in the stack to overturn the results
of those previous in the stack. Also note that each log entry is
filtered individually, it is not possible to make decisions for one
entry based on decisions that have been previously reached to accept
or reject other entries. There are no limits to what processing you
may do on each log entry but clearly when the filter has to be run on
every entry and there might be millions to process it is worth doing
only the minimum required if you want the entire process to complete
in a reasonable amount of time.
</p>

<h2>Structure of a log entry</h2>

<p>
When an entry is successfully parsed the separate parts are placed
into a hash - for speed reasons this is not done in an Object-Oriented
style. The following elements will be available for querying during
the filtering stage.
</p>

<ul>
  <li><em>year</em> - year part of date string</li>
  <li><em>month</em> - month part of date string</li>
  <li><em>day</em> - day part of date string</li>
  <li><em>hour</em> - hour part of date string</li>
  <li><em>minute</em> - minute part of date string</li>
  <li><em>second</em> - second part of date string</li>
  <li><em>nanosecond</em> - nanosecond part of date string (or zero
  if not specified in the log entry)</li>
  <li><em>time_zone</em> - time zone part of date string (or UTC if
  not specified in the log entry)</li>
  <li><em>hostname</em> - hostname part of log entry</li>
  <li><em>program</em> - program part of log entry</li>
  <li><em>pid</em> - pid part of log entry (undefined if not specified)</li>
  <li><em>message</em> - message part of the log entry</li>
  <li><em>raw</em> - original log entry string</li>
  <li><em>digest</em> - Base64 encode version of the SHA256 digest
  for the original log entry</li>
</ul>

</body>
</html>
